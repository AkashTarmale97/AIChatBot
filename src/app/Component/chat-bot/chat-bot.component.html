<div class="container">
  <h2>Service Flow Diagram</h2>

  <input type="text" [(ngModel)]="serviceName" placeholder="Enter Service Name" />
  <!-- Disable button if no service name -->
  <button (click)="fetchFlow()" [disabled]="!serviceName.trim()">Show Flow</button>

  <!-- Hide download button until diagram is visible -->
  <button *ngIf="showDiagram" (click)="generateImage()">Download as Image</button>

  <!-- Only show diagram when data is available -->
  <div class="flow-wrapper" *ngIf="showDiagram">
    <div #flowContainer class="flow-diagram">
      <ng-container *ngFor="let step of flowSteps; let last = last">
        
        <!-- Simple step -->
        <div class="flow-step" *ngIf="!isObject(step)">{{ step }}</div>

        <!-- Step with sub-steps -->
        <div class="flow-step" *ngIf="isObject(step)">
          <div class="main-step">{{ step.heading }}</div>
          <div class="sub-steps" *ngIf="step.subSteps">
            <div class="sub-step" *ngFor="let sub of step.subSteps | keyvalue">
              {{ sub.value }}
            </div>
          </div>
        </div>

        <!-- Arrow -->
        <div class="arrow" *ngIf="!last">â†’</div>
      </ng-container>
    </div>
  </div>
</div>
